<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Meteor-ipgeocoder by thebakeryio</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Meteor-ipgeocoder</h1>
      <h2 class="project-tagline">IP geocoder for Meteor</h2>
      <a href="https://github.com/thebakeryio/meteor-ipgeocoder" class="btn">View on GitHub</a>
      <a href="https://github.com/thebakeryio/meteor-ipgeocoder/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/thebakeryio/meteor-ipgeocoder/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="ip-address-geocoder-for-meteor" class="anchor" href="#ip-address-geocoder-for-meteor" aria-hidden="true"><span class="octicon octicon-link"></span></a>IP Address Geocoder for Meteor</h1>

<p>Geocode IP addresses using <a href="https://www.maxmind.com/">MaxMind</a> IP database. Here's a <a href="https://ipgeocoder.herokuapp.com/">demo</a>.</p>

<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>

<pre><code>meteor add thebakery:ipgeocoder
</code></pre>

<h2>
<a id="use-server-only" class="anchor" href="#use-server-only" aria-hidden="true"><span class="octicon octicon-link"></span></a>Use (server only)</h2>

<pre><code>// you can do it synchronously 
var geoData = IPGeocoder.geocode('82.124.236.10');

// or asynchronously
IPGeocoder.geocode('82.124.236.10', function(error, result){
    if(!error){
        // good to go
    }
});
</code></pre>

<p><strong>Note</strong>: IPGeocoder downloads and parses IP database in the background. You can either explicitly ask for the data to be downloaded or let IPGeocoder do it once the first call to geocode arrives. If the lib is busy downloading the database, it will throw an exception saying 'the database is not ready'. So it might be a good idea to load data on server startup</p>

<pre><code>// somewhere on the server
Meteor.startup(function(){
  IPGeocoder.load();
});
</code></pre>

<h2>
<a id="data-format" class="anchor" href="#data-format" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data Format</h2>

<p>By default, IPGeocoder.geocode will return data in the following format (which is probably sufficient for most cases)</p>

<pre><code>{
    city: {
        name: "Neuilly-sur-Seine"
    },
    continent: {
        name: "Europe",
        code: "EU"
    },
    country: {
        name: "France",
        code: "FR"
    },
    location: {
        latitude: 48.8833,
        longitude: 2.2667,
        time_zone: "Europe/Paris"
    }
}
</code></pre>

<p>You can also ask for verbose output based on MaxMind's <a href="http://dev.maxmind.com/geoip/geoip2/web-services/">spec</a></p>

<pre><code>var verbose = true;

// you can do it synchronously 
var geoData = IPGeocoder.geocode('82.124.236.10', null, verbose);

// or asynchronously
IPGeocoder.geocode('82.124.236.10', function(error, result){
    if(!error){
        // good to go
    }
}, verbose);
</code></pre>

<h2>
<a id="configure" class="anchor" href="#configure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configure</h2>

<p>By default, geocoder will download data from <a href="http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.mmdb.gz">http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.mmdb.gz</a>. You can adjust this in 2 ways:</p>

<pre><code>//ask for specific version to be loaded explicitly
IPGeocoder.load('http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.mmdb.gz');
</code></pre>

<p>Or adjust the path in Meteor.settings </p>

<pre><code>{
    "IPGeocoder" : {
        "databaseUrl" : "https://dl.dropboxusercontent.com/u/9224326/geogit/GeoLite2-City.mmdb.gz"
    }
}
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/thebakeryio/meteor-ipgeocoder">Meteor-ipgeocoder</a> is maintained by <a href="https://github.com/thebakeryio">thebakeryio</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

